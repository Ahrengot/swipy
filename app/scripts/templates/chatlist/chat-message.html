<% 
	var hasProfilePicture = "";
	var sender = swipy.collections.members.get(data.message.get("userId"));
	var hasAttachment = false;
	var numberOfLikes = data.message.get("numberOfLikes");
	var shouldShowBigLike = false;
	if( data.message.get("message").indexOf("attachment") != -1){
		hasAttachment = true;
		shouldShowBigLike = true;
	}
	if(numberOfLikes > 0){
		shouldShowBigLike = true;
	}
	var isLikedClass = ""
	if(data.message.get("likedByMe"))
		isLikedClass = "liked"

	var likeString = "Be the first to like this.";
	if(numberOfLikes > 0){
		if(data.message.get("likedByMe")){
			if(numberOfLikes == 1){
				likeString = "You like this.";
			}
			else{
				var numberLeft = numberOfLikes - 1;
				likeString = "You and " + numberLeft + " others like this."
			}
		}
		else{
			if(numberOfLikes == 1){
				likeString = "1 person like this."
			}
			else
				likeString = numberOfLikes + " people like this."
		}
	}
	

%>
<div class="chat-message">
	<div class="chat-left-side-container">
		<% if(!data.isFromSameSender){ %>
		<div class="picture-container">
			<div class="picture-circular" style="background: url(<%= sender.get("profileImageURL") %>) no-repeat; background-size: 40px 40px;">
			</div>
		</div>
		<% } else { %>
			<div class="left-hover-box">
				<% if(!shouldShowBigLike){ %>
				<a class="like-button">
					<svg class="icon">
						<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-thumb"></use>
					</svg>
				</a>
				<% } %>
				<span class="timestamp"><%= data.message.get("timeStr") %></span>
			</div>
		<% } %>
	</div>
	<div class="chat-right-side-container">
		<% if(!data.isFromSameSender){ %>
		<div class="sender-container">
			<span class="sender-name"><%= sender.get("username") %></span>
			<span class="timestamp"><%= data.message.get("timeStr") %></span>
			<% if(!shouldShowBigLike){ %> 
			<span class="top-hover-box">
				<a class="like-button">
					<svg class="icon">
						<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-thumb"></use>
					</svg>
				</a>
			</span>
			<% } %>
		</div>
		<% } %>
		<div class="message-container">
			<%= data.message.get("message") %>
		</div>
		<% if( hasAttachment ){ %>
		<div class="attachment-container">
			<a href="http://test.com" target="_blank"><img src="styles/img/temp/attachment-placeholder.png"></a>
		</div>
		<% } %>
		<% if(shouldShowBigLike){ %>
		<div class="like-container">
			<a class="like-button <%= isLikedClass %>">
				<svg class="icon">
					<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-thumb"></use>
				</svg>
				<!--Like<% if(isLikedClass.length > 0) print("d"); %>-->
			</a>
			<span class="like-string">
				<%= likeString %>
			</span>
		</div>
		<% } %>
	</div>
</div>