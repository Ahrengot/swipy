<% if (state === "active") { %>
<a href="JavaScript:void(0);" class="action complete left" title="Mark todo as completed">
	<span class="icon-checkmark"></span>
</a>
<% } else { %>
<a href="JavaScript:void(0);" class="action todo <%= (state === "completed") ? 'right' : 'left' %>" title="Move task to todo list">
	<span class="icon-todo"></span>
</a>
<% } %>
<a href="JavaScript:void(0);" class="action schedule right" title="Schedule todo">
	<span class="icon-clock"></span>
</a>
<%
	var centerTitle, isPriority, classList

	isPriority = (priority === 1)
	classList = "todo-content"

	if ( !( tags && tags.length || repeatDate || notes || completionDate ) ) {
		if ( state !== "completed" && state !== "scheduled" ) {
			classList += " center-title"
		} else if ( scheduleStr && scheduleStr === "unspecified" ) {
			classList += " center-title"
		}
	}

	if (priority === 1) {
		classList += " is-priority"
	}
%>

<div class="<%= classList %>">
	<h2><span class="priority"></span><%= title %> <% if(numberOfActionStepsLeft && numberOfActionStepsLeft > 0) print( " ( " + numberOfActionStepsLeft + " )" ); %></h2>

	<ul class="meta">
		<% if (notes) { %>
			<li title="<%= notes %>"><span class="icon-note"></span></li>
		<% } %>

		<% if (repeatDate) { %>
			<li title="This task will repeat on <%= repeatDate %>"><span class="icon-repeat"></span></li>
		<% } %>

		<% if (notes || repeatDate) { %>
			<% if (tags && tags.length) { %>
				<li class="seperator"></li>
			<% } %>
		<% } %>

		<li>
			<% if (state === "completed") { %>
				<time><%= completionTimeStr %></time>
			<% } else if (state === "scheduled" && scheduleStr !== "unspecified") { %>
				<time><%= timeStr %></time>
			<% } %>
		</li>

		<% if (state === "completed" || state === "scheduled" && scheduleStr !== "unspecified" ) { %>
			<% if (tags && tags.length) { %>
				<li class="seperator"></li>
			<% } %>
		<% } %>

		<% if (tags && tags.length) { %>
			<ul class="tags">
				<%
					tagStrings = _.invoke(tags, "get", "title")
					tagStrings = _.sortBy( tagStrings, function(tag) {
						return tag.toLowerCase()
					})

					_.each(tagStrings, function(tag) {
				%>

				<% if ( _.contains(swipy.filter.tagsFilter, tag) ) { %>
					<li><strong><%= tag %></strong></li>
				<% } else { %>
					<li><%= tag %></li>
				<% } %>

				<% }); %>
			</ul>
		<% } %>
	</ul>
</div>
<div class="actions">
	<div>
	<% if (state === "completed" || state === "active"){ %>
		<a href="JavaScript:void(0);" class="schedule-button" title="Schedule todo">
			<span class="icon-clock"></span>
		</a>
	<% } if (state === "completed" || state === "scheduled"){ %>
		<a href="JavaScript:void(0);" class="todo-button" title="Move task to todo list">
			<span class="icon-todo-bold"></span>
		</a>
	<% } if (state === "active" || state === "scheduled"){ %>
		<a href="JavaScript:void(0);" class="complete-button" title="Mark todo as completed">
			<span class="icon-checkmark-bold"></span>
		</a>
	<% } %>
	</div>
</div>